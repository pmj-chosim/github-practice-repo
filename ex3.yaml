import sqlite3

# ì‚¬ìš©ì ì…ë ¥ ì‹œë®¬ë ˆì´ì…˜ì„ ìœ„í•œ ë”ë¯¸ í•¨ìˆ˜
def get_request_data(key):
    # ì‹¤ì œ Flask ì•±ì—ì„œëŠ” request.args.get(key)ì™€ ìœ ì‚¬
    if key == 'username':
        return "test_user' OR 1=1 --"
    return ""

def authenticate_user():
    db = sqlite3.connect('example.db')
    cursor = db.cursor()
    
    # **ì·¨ì•½ì :** ì›¹ ìš”ì²­ìœ¼ë¡œë¶€í„° ë°›ì€ ì…ë ¥(username)ì„ ì§ì ‘ SQL ì¿¼ë¦¬ì— ì‚½ì…
    username = get_request_data('username')
    
    # ğŸš¨ CodeQLì´ ëª…í™•íˆ ì¸ì‹í•  ìˆ˜ ìˆëŠ” ìœ„í—˜í•œ ë¬¸ìì—´ ì—°ê²° ë°©ì‹
    query = "SELECT role FROM users WHERE username = '" + username + "' AND active = 1"
    
    print(f"Executing query: {query}")
    cursor.execute(query)
    data = cursor.fetchone()
    db.close()
    
    return data

authenticate_user()
